angular.module("lodashFilter",[]).filter("unders",function(){return function(e){return e.replace(/_/g," ")}});var app=angular.module("Howfast",["ngResource","ngRoute","lodashFilter","ui.bootstrap","ngMessages"]);app.config(["$routeProvider",function(e){e.when("/",{templateUrl:"partials/home.html",controller:"HomeCtrl"}).otherwise({redirectTo:"/"})}]),app.controller("HomeCtrl",["$scope","$http",function(e,s){e.choices=[{id:"mens 100",db:"mo_100"},{id:"mens 200",db:"mo_200"},{id:"mens 400",db:"mo_400"},{id:"mens 800",db:"mo_800"},{id:"mens 1500",db:"mo_1500"},{id:"mens 5000",db:"mo_5000"},{id:"mens 10000",db:"mo_10000"},{id:"mens half marathon",db:"mo_half"},{id:"mens marathon",db:"mo_marathon"},{id:"womens 100",db:"wo_100"},{id:"womens 200",db:"wo_200"},{id:"womens 400",db:"wo_400"},{id:"womens 800",db:"wo_800"},{id:"womens 1500",db:"wo_1500"},{id:"womens 5000",db:"wo_5000"},{id:"womens 10000",db:"wo_10000"},{id:"womens half marathon",db:"wo_half"},{id:"womens marathon",db:"wo_marathon"}];var o=function(){e.hasHours=!1,e.hasMinutes=!1,e.hasSeconds=!1,e.hasHundredths=!1,e.hours=null,e.minutes=null,e.seconds=null,e.hundredths=null,e.isChecked=!1};e.isSelected=!1,e.isChecked=!1,e.myTime=0,e.selectEvent=function(){switch(o(),s.get("/api/times",{params:{db:e.distance.db}}).then(function(s){e.events=s.data,e.isSelected=!0,e.isChecked=!1}),e.distance.db){case"mo_100":case"mo_200":case"mo_400":case"wo_100":case"wo_200":case"wo_400":e.hasSeconds=!0,e.hasHundredths=!0;break;case"mo_800":case"wo_800":e.hasMinutes=!0,e.hasSeconds=!0,e.hasHundredths=!0;break;case"mo_1500":case"mo_5000":case"mo_10000":case"wo_1500":case"wo_5000":case"wo_10000":e.hasMinutes=!0,e.hasSeconds=!0;break;case"mo_half":case"mo_marathon":case"wo_half":case"wo_marathon":e.hasHours=!0,e.hasMinutes=!0,e.hasSeconds=!0}},e.newConvertedArray=[],e.check=function(){d3.selectAll("path").style("fill","teal");var s=e.hours||0,o=e.minutes||0,a=e.seconds||0,t=e.hundredths||0;e.myTime=3600*s+60*o+ +a+t/100,e.slowArray=[],e.mapArray=[],e.events.map(function(s){s.seconds>e.myTime&&e.slowArray.push({country:s.country,nationality:s.nationality,time:s.time,seconds:s.seconds})}),e.isChecked=!0,e.newConvertedArray=e.slowArray.map(function(e){return e.country.replace("Great Britain and N.I.","United Kingdom").replace(/ /g,"_")}),e.newConvertedArray.forEach(function(e){d3.select("#"+e).style("fill","red")}),d3.select("#Somaliland").style("fill","black"),d3.select("#Northern_Cyprus").style("fill","black"),d3.select("#Greenland").style("fill","black"),d3.select("#Western_Sahara").style("fill","black"),d3.select("#South_Sudan","black").style("fill","black"),d3.select("#Falkland_Islands","black").style("fill","black"),d3.select("#Former_South_Antarctic_Lands").style("fill","black")},e.clear=function(){e.hours=0,e.minutes=0,e.seconds=0,e.hundredths=0,e.isChecked=!1,d3.selectAll("path").style("fill","teal")};var a=d3.geo.mercator().center([0,35]).scale(175).rotate([0,0]),t=d3.select(".map").append("svg").attr("width","100%").attr("viewBox","0 0 1000 600"),n=d3.geo.path().projection(a),d=t.append("g");d3.json("/topoJson/tworld.json",function(e,s){if(e)return console.error(e);d.selectAll("path").data(topojson.object(s,s.objects.world).geometries).enter().append("path").attr("d",n).attr("id",function(e){return e.properties.name})})}]);